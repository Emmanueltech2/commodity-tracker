<?xml version="1.0"?>
<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:jr="http://openrosa.org/javarosa" xmlns:odk="http://www.opendatakit.org/xforms" xmlns:orx="http://openrosa.org/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <h:head>
    <h:title>New Family</h:title>
    <model odk:xforms-version="1.0.0">
      <instance>
        <a54WWtSqvaNak36tmWLDcX id="family">
          <init>
            <conduct_registration/>
            <ensure/>
          </init>
          <check>
            <registered/>
            <household_area/>
            <serving_household/>
            <specify/>
          </check>
          <caregiver>
            <names/>
            <optional/>
            <gender/>
            <age/>
            <primary_number/>
            <secondary_number/>
            <confirm/>
            <certificate/>
            <children/>
            <women/>
            <pregnant/>
            <pregnancy_form/>
            <fp_form/>
          </caregiver>
          <other_fam>
            <family_mem/>
            <add_fam/>
            <repeat_fam jr:template="">
              <fam_names/>
              <method_dob/>
              <cal_dob/>
              <cal_years/>
              <cal_age/>
              <fam_years/>
              <fam_month/>
              <fam_gender/>
              <relationship/>
              <fam_number/>
              <birth_cert/>
              <sleep_net/>
            </repeat_fam>
            <repeat_fam>
              <fam_names/>
              <method_dob/>
              <cal_dob/>
              <cal_years/>
              <cal_age/>
              <fam_years/>
              <fam_month/>
              <fam_gender/>
              <relationship/>
              <fam_number/>
              <birth_cert/>
              <sleep_net/>
            </repeat_fam>
          </other_fam>
          <meta>
            <instanceID/>
          </meta>
        </a54WWtSqvaNak36tmWLDcX>
      </instance>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/init/conduct_registration" required="true()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/init/ensure" readonly="true()" relevant=" /a54WWtSqvaNak36tmWLDcX/init/conduct_registration  = 'person'" type="string"/>
      <bind constraint="selected( /a54WWtSqvaNak36tmWLDcX/check/registered ,'no')" jr:constraintMsg="Please exit the workflow. The household is already registered !" nodeset="/a54WWtSqvaNak36tmWLDcX/check/registered" required="true()" type="string"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/check/household_area" relevant="selected( /a54WWtSqvaNak36tmWLDcX/check/registered , 'no')" required="true()" type="string"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/check/serving_household" relevant="selected( /a54WWtSqvaNak36tmWLDcX/check/household_area , 'no')" required="true()" type="string"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/check/specify" relevant="selected( /a54WWtSqvaNak36tmWLDcX/check/serving_household , 'other')" required="true()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver" relevant="selected( /a54WWtSqvaNak36tmWLDcX/check/registered , 'no')"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/names" required="true()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/optional" required="false()" type="string"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/gender" required="true()" type="string"/>
      <bind constraint=". &gt;= 1 and . &lt;= 120" jr:constraintMsg="Age must be between 1 and 120" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/age" required="true()" type="int"/>
      <bind constraint="regex(., '^(01\d{8}|07\d{8})$')" jr:constraintMsg="Please make sure the number is not already in use by another person and is in the format 07XX XXX XXX or 01XX XXX XXX." nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/primary_number" required="false()" type="string"/>
      <bind constraint="regex(., '^(01\d{8}|07\d{8})$')" jr:constraintMsg="Please make sure the number is not already in use by another person and is in the format 07XX XXX XXX or 01XX XXX XXX." nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/secondary_number" required="false()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/confirm" readonly="true()" relevant="string-length( /a54WWtSqvaNak36tmWLDcX/caregiver/primary_number ) &gt; 0" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/certificate" required="true()" type="string"/>
      <bind constraint=". &gt;=0" jr:constraintMsg="Number of children must be greater or equal to 0" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/children" required="true()" type="int"/>
      <bind constraint=". &gt;=0" jr:constraintMsg="Number of women must be greater or equal to 0" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/women" required="true()" type="int"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/pregnant" relevant="selected( /a54WWtSqvaNak36tmWLDcX/caregiver/gender , 'female')" required="true()" type="string"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/pregnancy_form" readonly="true()" relevant="selected( /a54WWtSqvaNak36tmWLDcX/caregiver/pregnant , 'yes')" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/caregiver/fp_form" readonly="true()" relevant="selected( /a54WWtSqvaNak36tmWLDcX/caregiver/pregnant , 'no')" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/family_mem" required="true()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/add_fam" readonly="true()" relevant="selected( /a54WWtSqvaNak36tmWLDcX/other_fam/family_mem , 'yes')" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam" relevant="selected( /a54WWtSqvaNak36tmWLDcX/other_fam/family_mem , 'yes')"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_names" required="true()" type="string"/>
      <bind jr:constraintMsg="This field is required" nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/method_dob" required="true()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/cal_dob" relevant="selected( ../method_dob , 'calendar')" required="true()" type="date"/>
      <bind calculate="int(floor((today() -  ../cal_dob ) div 365.25))" nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/cal_years" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/cal_age" readonly="true()" type="string"/>
      <bind constraint=". &gt;= 0 and . &lt;= 130" jr:constraintMsg="Age must be between 0 and 130" nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_years" relevant="selected( ../method_dob , 'curr_age')" required="true()" type="int"/>
      <bind constraint=". &gt;= 0 and . &lt;= 11" jr:constraintMsg="Months must between 0 and 11" nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_month" relevant="selected( ../method_dob , 'curr_age')" required="true()" type="int"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_gender" required="true()" type="string"/>
      <bind constraint="(. = 'spouse' and  ../cal_age  &gt;= 15) or ( ../cal_age  &gt;= 0) or (. = 'sister' and  ../fam_gender  = 'female') or (. = 'brother' and  ../fam_gender  = 'male') or ( ../fam_gender  != 'sister' and  ../fam_gender  != 'brother')" jr:constraintMsg="Invalid selection. Check on the relationship to the caregiver and the age i.e. a spouse cannot be under 15 years. Check the relationship to the caregiver and the gender i.e. a sister cannot be male and a brother cannot be female." nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/relationship" type="string"/>
      <bind constraint="regex(., '^(01\d{8}|07\d{8})$')" jr:constraintMsg="Please make sure the number is not already in use by another person and is in the format 07XX XXX XXX or 01XX XXX XXX." nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_number" relevant=" ../cal_age  &gt;= 16" required="false()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/birth_cert" required="true()" type="string"/>
      <bind nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/sleep_net" required="true()" type="string"/>
      <bind jr:preload="uid" nodeset="/a54WWtSqvaNak36tmWLDcX/meta/instanceID" readonly="true()" type="string"/>
    </model>
  </h:head>
  <h:body class="pages">
    <group appearance="field-list" ref="/a54WWtSqvaNak36tmWLDcX/init">
      <label>Registration method</label>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/init/conduct_registration">
        <label>How are you conducting this household registration?</label>
        <item>
          <label>In Person</label>
          <value>person</value>
        </item>
        <item>
          <label>By Phone</label>
          <value>phone</value>
        </item>
      </select1>
      <input ref="/a54WWtSqvaNak36tmWLDcX/init/ensure">
        <label>&lt;p style = "color:red; font-weight:bold"&gt;Ensure you are dressed in personal protective equipment (PPE) including a mask and gloves. Keep a distance of 2 meters (2 -3 steps) when attending to the client and wash hands with soap and running water before and after attending to the household.</label>
      </input>
    </group>
    <group appearance="field-list" ref="/a54WWtSqvaNak36tmWLDcX/check">
      <label>Registration check</label>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/check/registered">
        <label>Has this Household been registered by another CHV?</label>
        <item>
          <label>Yes</label>
          <value>yes</value>
        </item>
        <item>
          <label>No</label>
          <value>no</value>
        </item>
      </select1>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/check/household_area">
        <label>Is this household in your area?</label>
        <item>
          <label>Yes</label>
          <value>yes</value>
        </item>
        <item>
          <label>No</label>
          <value>no</value>
        </item>
      </select1>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/check/serving_household">
        <label>Why are you serving this household?</label>
        <item>
          <label>There is no CHV in the clients area</label>
          <value>no_chv</value>
        </item>
        <item>
          <label>Patient needs treatment</label>
          <value>treatment</value>
        </item>
        <item>
          <label>Boundaries of my area are not clear</label>
          <value>boundaries</value>
        </item>
        <item>
          <label>Other</label>
          <value>other</value>
        </item>
      </select1>
      <input ref="/a54WWtSqvaNak36tmWLDcX/check/specify">
        <label>Please specify</label>
      </input>
    </group>
    <group appearance="field-list" ref="/a54WWtSqvaNak36tmWLDcX/caregiver">
      <label>Primary Caregiver</label>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/names">
        <label>Names</label>
      </input>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/optional">
        <label>Notes (optional)</label>
      </input>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/caregiver/gender">
        <label>Gender</label>
        <item>
          <label>Male</label>
          <value>male</value>
        </item>
        <item>
          <label>Female</label>
          <value>female</value>
        </item>
      </select1>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/age">
        <label>Age</label>
      </input>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/primary_number">
        <label>Primary Mobile Number &lt;br&gt; &lt;p style = "font-size: 9; font-style:italic; opacity:0.3"&gt; Use one of the following formats: 07XX XXX XXX or 01XX XXX XXX &lt;/p&gt;</label>
      </input>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/secondary_number">
        <label>Secondary Mobile Number &lt;br&gt; &lt;p style = "font-size: 9; font-style:italic; opacity:0.3"&gt; Use one of the following formats: 07XX XXX XXX or 01XX XXX XXX &lt;/p&gt;</label>
      </input>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/confirm">
        <label> &lt;p style = &quot;font-weight: bold&quot;&gt;Please verify that the phone numbers are accurate
&lt;br&gt;Primary Number: <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/primary_number "/> &lt;br&gt;Secondary Number: <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/secondary_number "/>&lt;/p&gt; </label>
      </input>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/caregiver/certificate">
        <label> Does <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/names "/> have certificate? </label>
        <item>
          <label>Yes</label>
          <value>yes</value>
        </item>
        <item>
          <label>No</label>
          <value>no</value>
        </item>
      </select1>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/children">
        <label> How many children under 5 are in the family of <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/names "/>? </label>
      </input>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/women">
        <label> How many women aged 10 and 49 are <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/names "/> household? (including the primary caregiver) </label>
      </input>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/caregiver/pregnant">
        <label> Is <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/names "/> currently pregnant? </label>
        <item>
          <label>Yes</label>
          <value>yes</value>
        </item>
        <item>
          <label>No</label>
          <value>no</value>
        </item>
      </select1>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/pregnancy_form">
        <label> &lt;p style = &quot;font-weight: bold&quot;&gt;Remember to complete a pregnancy registration for <output value=" /a54WWtSqvaNak36tmWLDcX/caregiver/names "/>. &lt;/p&gt; </label>
      </input>
      <input ref="/a54WWtSqvaNak36tmWLDcX/caregiver/fp_form">
        <label>&lt;p style = "font-weight:bold"&gt;Please fill out an FP form for the primary caregiver after registration&lt;/p&gt;&lt;br&gt;&lt;p style = "font-size: 9; font-style:italic; opacity:0.3"&gt;Applicable only to the following branches: Butula, Malava, Port Victoria, Shinyalu and Suneka</label>
      </input>
    </group>
    <group appearance="field-list" ref="/a54WWtSqvaNak36tmWLDcX/other_fam">
      <label>Other family members</label>
      <select1 ref="/a54WWtSqvaNak36tmWLDcX/other_fam/family_mem">
        <label>Do you have other family members?</label>
        <item>
          <label>Yes</label>
          <value>yes</value>
        </item>
        <item>
          <label>No</label>
          <value>no</value>
        </item>
      </select1>
      <input ref="/a54WWtSqvaNak36tmWLDcX/other_fam/add_fam">
        <label>&lt;p style = "font-weight: bold"&gt;MESSAGE TO CHV: &lt;/p&gt;Please add all the family members</label>
      </input>
      <group ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam">
        <label>NO_LABEL</label>
        <repeat nodeset="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam">
          <input appearance="page" ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_names">
            <label>Names</label>
          </input>
          <select1 ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/method_dob">
            <label>Method to select date of birth</label>
            <item>
              <label>With calendar (preferred)</label>
              <value>calendar</value>
            </item>
            <item>
              <label>With current age</label>
              <value>curr_age</value>
            </item>
          </select1>
          <input ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/cal_dob">
            <label>Date of Birth</label>
          </input>
          <input ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/cal_age">
            <label> &lt;p style = &quot;font-size: 9; font-style:italic; opacity:0.3&quot;&gt;Age in years&lt;/p&gt;<output value=" ../cal_age "/> </label></input>
          <input ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_years">
            <label>Age &lt;br&gt; &lt;p style = "font-size: 9; font-style:italic; opacity:0.3"&gt;Age in years&lt;/p&gt;</label>
          </input>
          <input ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_month">
            <label>&lt;p style = "font-size: 9; font-style:italic; opacity:0.3"&gt;Age in months&lt;/p&gt;</label>
          </input>
          <select1 ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_gender">
            <label>Gender</label>
            <item>
              <label>Male</label>
              <value>male</value>
            </item>
            <item>
              <label>Female</label>
              <value>female</value>
            </item>
          </select1>
          <select1 ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/relationship">
            <label>What is the relationship to the primary caregiver?</label>
            <item>
              <label>Spouse</label>
              <value>spouse</value>
            </item>
            <item>
              <label>Child</label>
              <value>child</value>
            </item>
            <item>
              <label>Grandchild</label>
              <value>grandchild</value>
            </item>
            <item>
              <label>Brother</label>
              <value>brother</value>
            </item>
            <item>
              <label>Sister</label>
              <value>sister</value>
            </item>
            <item>
              <label>Other</label>
              <value>fam_other</value>
            </item>
          </select1>
          <input ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/fam_number">
            <label><output value=" ../fam_names "/> Mobile Number &lt;br&gt; &lt;p style = &quot;font-size: 9; font-style:italic; opacity:0.3&quot;&gt; Use one of the following formats: 07XX XXX XXX or 01XX XXX XXX &lt;/p&gt; </label></input>
          <select1 ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/birth_cert">
            <label> Does <output value=" ../fam_names "/> have a birth certificate? </label>
            <item>
              <label>Yes</label>
              <value>yes</value>
            </item>
            <item>
              <label>No</label>
              <value>no</value>
            </item>
          </select1>
          <select1 ref="/a54WWtSqvaNak36tmWLDcX/other_fam/repeat_fam/sleep_net">
            <label> Did <output value=" ../fam_names "/> sleep under insecticide treated net? </label>
            <item>
              <label>Yes</label>
              <value>yes</value>
            </item>
            <item>
              <label>No</label>
              <value>no</value>
            </item>
          </select1>
        </repeat>
      </group>
    </group>
  </h:body>
</h:html>
